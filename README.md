# tani

Commandline tool for generating language data sets for Tani dialects.

## System requirements

Requires a Mac or Linux with Node.js (4+) and Neo4j installation.

## Understanding the directories and files

The whole project is built around a directory named `concepts`, where directories/sub-directories of concept definition files are stored.

A concept definition file is just a `.txt` file with the following structure.

```
Concise definition.

[Note: Special note]

[Eg: word = definition; in tribe/locality]
```

For example:

```
Good to experience

Note: Used for describing quality of being.

Eg: kaa[pyo] = beautiful; in apatani/hari
Eg: kaa[ken] = beautiful; in galo/aalo
Eg: kam[po] = beautiful; in adi/pasighat
```

Concept files can be created using the `add` command or manually. When adding manually, the file name should be next largest number in the directory.

Dialect files, and hence queries, are created from these concept files.

### Summary

* `concepts` - directory of concept text files
* `dialects` - text file under dialects/tribe/locality, which contain root word information for a particular dialect
* `queries` - directory of `acf` files, ready to be pushed to the database

## Adding concepts

The following command will add a new noun concept for "Animal", and assign the immediate largest number as its id (filename) and create the corresponding file in the directory.

```
tani add n "Animal"
```

The following command will create a new noun concept file under the `ornaments` directory. If the directory does not exist, it will be created. Since the concept string is not specified, the file will be empty.

```
tani add n/ornaments
```

A new concept can be added and made to take over the id of an existing concept using the `add @` command. In such cases, the existing file and all other files after it will be shifted by a value of 1. The same will happen in the `dialects` directory.

`tani compile --all` and `tani publish` must be run after every `add @` command to keep the source files updated.

```
tani add v@1 "Do"
```

```
tani add n/animals/insects@5 "Grasshopper"
```

## Deleting concepts

The following command will delete an existing concept at the specified index. 

```
tani delete n@10
```

The following command will delete all the existing concepts in a directory. 

```
tani delete n/animals
```

When a concept file is deleted, the corresponding dialect file is also be deleted.

`tani compile --all` and `tani publish` must be run after every `add @` command to keep the source files updated.

## Updating concepts

An existing concept can be updated by editing its `.txt` file.

`tani sync --all` must be run after any edits concept files to keep the source files updated.

## Adding a new dialect

A dialect is identified using the tribe and locality (`<tribe>/<locality>`).

Add a new dialect:

```
tani init apatani/hari
```

This will create the `apatani/hari` dialect directory under the `dialects` dir at the root of the project. The corresponding dialect files for the dialect will be generated from the `concepts` directory.

This command merely generates the dialect files, the files need to be manually edited to make entries for the dialect by experts in the dialect.

A dialect can be initialized from an existing dialect, this saves time in making entries when the dialects have a lot of similarities.

```
tani init apatani/hija from apatani/hari
```

The dialect files for `apatani/hija` will be created by copying the contents of `apatani/hari`.

## Syncing dialect files with new concepts

New concepts may be added to the `concepts` directory, or an existing one edited.

To reflect the changes in all the dialects:

```
tani sync --all
```

To reflect the changes all the dialects of a tribe:

```
tani sync apatani
```

To reflect the changes in a dialect:

```
tani sync apatani/hari
```

## Deleting dialects

Use the `uninit ` command to delete the dialect directories generated by the `init` command.

Delete everything:

```
tani uninit --all
```

Delete all the dialects of a tribe:

```
tani uninit apatani
```

Delete a dialect:

```
tani uninit apatani/hari
```

## Compiling

Concept and dialect files files have to be compiled to generate the query files. Only query files can be `publish`ed.

Compile everything:

```
tani compile --all
```

Compile concepts:

```
tani compile --concepts
```

Compile all the dialects of a tribe:

```
tani compile apatani
```

Compile a dialect:

```
tani compile apatani/hari
```

The generated `queries` directory can be regenarated using the `compile` command, so the directory should be put in `.gitignore`.

## Publishing

The `publish` command must be run at the root of the `queries` directory. It erases the existing entries in the database, and populate it with the new queries. The `compile` command must be run, before `publish` can be run.

Publish everything:

```
tani publish --all
```

Publish a specific tribe:

```
tani publish apatani
```

Publish a specific dialect:

```
tani publish apatani/hari
```

Publish a specific concept directory:

```
tani publish apatani/hari/n
```

Publish a specific concept:

```
tani publish apatani/hari/n/animals@10
```

## Unpublishing 

Use the `unpublish` command to remove entries from the database. This will not affect the local files, only the entries in the database will be removed.

Unpublish everything:

```
tani unpublish --all
```

Unpublish a specific tribe:

```
tani unpublish apatani
```

Unpublish a specific dialect:

```
tani unpublish apatani/hari
```

Publish a specific concept directory:

```
tani unpublish apatani/hari/n
```

Publish a specific concept:

```
tani unpublish apatani/hari/n/animals@10
```

## License

[MIT](LICENSE)